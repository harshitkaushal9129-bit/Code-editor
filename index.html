<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DevStudio Pro - Ultimate Editor</title>
    
    <meta name="theme-color" content="#007acc">
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="Kaushalji.png">

    <style>
        :root { 
            --primary: #007acc; 
            --bg: #0f0f0f; 
            --panel: #1a1a1a; 
            --border: #333; 
            --text-color: #9cdcfe;
            --editor-bg: #1e1e1e;
        }
        
        /* Light Mode Variables */
        .light-mode {
            --bg: #ffffff;
            --panel: #f3f3f3;
            --border: #ccc;
            --text-color: #000000;
            --editor-bg: #ffffff;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: white; height: 100vh; display: flex; flex-direction: column; overflow: hidden; }

        /* Professional Toolbar */
        .top-nav { background: var(--panel); padding: 5px 15px; display: flex; gap: 20px; border-bottom: 1px solid var(--border); font-size: 13px; color: var(--text-color); }
        .menu-item { cursor: pointer; color: #888; transition: 0.2s; }
        .menu-item:hover { color: var(--primary); }

        header { background: #1e1e1e; padding: 10px 15px; display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid var(--border); }
        .logo-section { display: flex; align-items: center; gap: 10px; }
        .logo-img { width: 28px; height: 28px; border-radius: 4px; object-fit: cover; }
        .logo-text { font-size: 18px; font-weight: bold; color: var(--primary); }

        /* Tools Bar (New) */
        .tools-bar {
            background: #252526;
            padding: 5px 15px;
            display: flex;
            align-items: center;
            gap: 15px;
            border-bottom: 1px solid var(--border);
            flex-wrap: wrap;
        }
        .tool-select, .tool-btn {
            background: #333;
            color: white;
            border: 1px solid #444;
            padding: 3px 8px;
            font-size: 12px;
            border-radius: 3px;
            outline: none;
        }

        /* Main App Layout */
        .main-layout { display: flex; flex: 1; overflow: hidden; }
        .sidebar { width: 50px; background: #181818; border-right: 1px solid var(--border); display: flex; flex-direction: column; align-items: center; padding-top: 15px; gap: 25px; }
        .sidebar-icon { font-size: 20px; color: #858585; cursor: pointer; transition: 0.3s; }
        .sidebar-icon:hover { color: white; transform: scale(1.1); }

        /* Tab System (New) */
        .editor-tabs {
            display: flex;
            background: #2d2d2d;
            border-bottom: 1px solid var(--border);
        }
        .tab {
            padding: 8px 20px;
            cursor: pointer;
            font-size: 12px;
            color: #999;
            border-right: 1px solid var(--border);
            background: #2d2d2d;
        }
        .tab.active {
            background: var(--editor-bg);
            color: white;
            border-top: 1px solid var(--primary);
        }

        .workspace { display: flex; flex: 1; overflow: hidden; }
        @media (max-width: 768px) { .workspace { flex-direction: column; } }

        .editor-panels { width: 60%; display: flex; flex-direction: column; border-right: 2px solid var(--border); background: var(--editor-bg); }
        @media (max-width: 768px) { .editor-panels { width: 100%; height: 50%; } }

        /* Hide/Show Panels based on Tab */
        .panel { display: none; flex-direction: column; height: 100%; }
        .panel.active { display: flex; }

        .panel-header { display: flex; justify-content: space-between; align-items: center; padding: 5px 15px; background: rgba(0,0,0,0.1); }
        .panel-header label { font-size: 10px; font-weight: bold; color: #888; text-transform: uppercase; }

        textarea { 
            width: 100%; 
            flex: 1;
            background: var(--editor-bg); 
            color: var(--text-color); 
            border: none; 
            padding: 15px; 
            font-family: 'Consolas', 'Courier New', monospace; 
            outline: none; 
            font-size: 14px; 
            line-height: 1.6; 
            resize: none; 
        }

        .preview-area { width: 40%; background: white; position: relative; }
        @media (max-width: 768px) { .preview-area { width: 100%; height: 50%; } }
        iframe { width: 100%; height: 100%; border: none; background: white; }

        /* Professional Buttons */
        .btn { padding: 6px 12px; border-radius: 4px; border: none; cursor: pointer; font-size: 11px; font-weight: bold; transition: 0.2s; display: flex; align-items: center; gap: 5px; }
        .html-btn { background: #e34f26; color: white; }
        .css-btn { background: #007acc; color: white; }
        .js-btn { background: #f7df1e; color: black; }
        .run-btn { background: #4caf50; color: white; }
        .btn:hover { filter: brightness(1.2); transform: translateY(-1px); }

        footer { background: var(--primary); color: white; padding: 3px 12px; font-size: 11px; display: flex; justify-content: space-between; font-weight: 500; z-index: 10; }
        
        /* Modal Style */
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); justify-content: center; align-items: center; backdrop-filter: blur(3px); }
        .modal-content { background: var(--panel); padding: 25px; border-radius: 12px; width: 320px; text-align: center; border: 1px solid var(--border); box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .modal-content h3 { margin-bottom: 15px; color: var(--primary); }
        .close-btn { background: var(--primary); color: white; border: none; padding: 10px 20px; margin-top: 20px; border-radius: 6px; cursor: pointer; font-weight: bold; width: 100%; }
    </style>
</head>
<body>

<div class="top-nav">
    <div class="menu-item" onclick="showShortcuts()">File</div>
    <div class="menu-item" onclick="clearAll()">Edit</div>
    <div class="menu-item" onclick="alert('Searching feature coming soon!')">Selection</div>
    <div class="menu-item" onclick="showModal('helpModal')">Help</div>
    <div class="menu-item" onclick="showModal('devModal')" style="color: #f7df1e;">Developer</div>
</div>

<header>
    <div class="logo-section">
        <img src="Kaushalji.png" alt="Logo" class="logo-img" onerror="this.src='https://cdn-icons-png.flaticon.com/512/1005/1005141.png'">
        <div class="logo-text">DevStudio Pro</div>
    </div>
    <div style="display: flex; gap: 10px;">
        <button id="installBtn" class="btn" style="background:#4caf50; display:none;">üì• Install App</button>
        <button class="btn run-btn" onclick="runPreview()">‚ñ∂ Run (Ctrl+Enter)</button>
    </div>
</header>

<div class="tools-bar">
    <select class="tool-select" onchange="changeFontSize(this.value)">
        <option value="12px">Font: 12px</option>
        <option value="14px" selected>Font: 14px</option>
        <option value="16px">Font: 16px</option>
        <option value="18px">Font: 18px</option>
        <option value="20px">Font: 20px</option>
    </select>

    <select class="tool-select" onchange="changeFontStyle(this.value)">
        <option value="'Consolas', monospace">Consolas</option>
        <option value="'Courier New', monospace">Courier New</option>
        <option value="serif">Serif</option>
        <option value="sans-serif">Sans-Serif</option>
    </select>

    <button class="tool-btn" onclick="toggleTheme()">üåì Toggle Theme</button>
</div>

<div class="main-layout">
    <div class="sidebar">
        <div class="sidebar-icon" title="Explorer">üìÇ</div>
        <div class="sidebar-icon" title="Search">üîç</div>
        <div class="sidebar-icon" title="Git">üåø</div>
        <div class="sidebar-icon" title="Extensions">üß©</div>
        <div style="flex: 1;"></div>
        <div class="sidebar-icon" title="Settings" style="margin-bottom: 15px;">‚öôÔ∏è</div>
    </div>

    <div class="workspace">
        <div class="editor-panels">
            <div class="editor-tabs">
                <div class="tab active" id="tab-html" onclick="switchTab('html')">index.html</div>
                <div class="tab" id="tab-css" onclick="switchTab('css')">style.css</div>
                <div class="tab" id="tab-js" onclick="switchTab('js')">script.js</div>
            </div>

            <div id="panel-html" class="panel active">
                <div class="panel-header">
                    <label>HTML5</label>
                    <button class="btn html-btn" onclick="saveFile('html')">Save HTML</button>
                </div>
                <textarea id="html-code" placeholder="<html> code here... " spellcheck="false" oninput="runPreview()"></textarea>
            </div>

            <div id="panel-css" class="panel">
                <div class="panel-header">
                    <label>CSS3</label>
                    <button class="btn css-btn" onclick="saveFile('css')">Save CSS</button>
                </div>
                <textarea id="css-code" placeholder="/* CSS Code Yahan Likhein */" spellcheck="false" oninput="runPreview()"></textarea>
            </div>

            <div id="panel-js" class="panel">
                <div class="panel-header">
                    <label>JavaScript</label>
                    <button class="btn js-btn" onclick="saveFile('js')">Save JS</button>
                </div>
                <textarea id="js-code" placeholder="// JS Code Yahan Likhein" spellcheck="false" oninput="runPreview()"></textarea>
            </div>
        </div>

        <div class="preview-area">
            <iframe id="output"></iframe>
        </div>
    </div>
</div>

<footer>
    <div id="status-bar">‚óè Mode: Dark | UTF-8</div>
    <div>Designed by Kaushal ‚Ä¢ v1.0.6</div>
</footer>

<div id="helpModal" class="modal">
    <div class="modal-content">
        <h3>User Guide</h3>
        <p style="font-size: 13px; color: #ccc; line-height: 1.6;">DevStudio ek PWA hai. Aap Tabs ke beech switch karke HTML/CSS/JS code likh sakte hain.</p>
        <button class="close-btn" onclick="hideModal('helpModal')">Samajh Gaya</button>
    </div>
</div>

<div id="devModal" class="modal">
    <div class="modal-content">
        <img src="Kaushalji.png" style="width: 60px; border-radius: 50%; margin-bottom: 10px;" onerror="this.style.display='none'">
        <h3>Developer Info</h3>
        <p style="font-size: 15px; color: #f7df1e; font-weight: bold;">Kaushal</p>
        <p style="font-size: 12px; color: #aaa; margin-top: 5px;">Build Version: 1.0.6 Pro<br>App Status: Stable</p>
        <button class="close-btn" onclick="hideModal('devModal')">Close</button>
    </div>
</div>

<script>
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
            navigator.serviceWorker.register('./sw.js').catch(err => console.log('SW Error'));
        });
    }
        </script>
    <script>// --- Tab Switching Logic ---
    function switchTab(type) {
        // Remove active class from all tabs and panels
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));

        // Add active class to selected
        document.getElementById('tab-' + type).classList.add('active');
        document.getElementById('panel-' + type).classList.add('active');
    }

    // --- Toolbar Actions ---
    function changeFontSize(size) {
        document.querySelectorAll('textarea').forEach(t => t.style.fontSize = size);
    }

    function changeFontStyle(font) {
        document.querySelectorAll('textarea').forEach(t => t.style.fontFamily = font);
    }

    function toggleTheme() {
        document.body.classList.toggle('light-mode');
        const isLight = document.body.classList.contains('light-mode');
        document.getElementById('status-bar').innerText = `‚óè Mode: ${isLight ? 'Light' : 'Dark'} | UTF-8`;
    }

    // --- Previous Systems ---
    let deferredPrompt;
    const installBtn = document.getElementById('installBtn');

    window.addEventListener('beforeinstallprompt', (e) => {
        e.preventDefault();
        deferredPrompt = e;
        installBtn.style.display = 'flex';
    });

    installBtn.addEventListener('click', () => {
        if (deferredPrompt) {
            deferredPrompt.prompt();
            deferredPrompt.userChoice.then(() => { installBtn.style.display = 'none'; });
        }
    });

    function runPreview() {
        const html = document.getElementById("html-code").value;
        const css = "<style>" + document.getElementById("css-code").value + "</style>";
        const js = "<script>" + document.getElementById("js-code").value + "<\/script>";
        const outputFrame = document.getElementById("output").contentWindow.document;
        outputFrame.open(); 
        outputFrame.write(html + css + js); 
        outputFrame.close();
    }

    function saveFile(type) {
        const content = document.getElementById(type + "-code").value;
        const filename = type === 'html' ? 'index.html' : type === 'css' ? 'style.css' : 'script.js';
        if(!content.trim()) return alert("Khaali file save nahi ho sakti!");
        const blob = new Blob([content], { type: "text/plain" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url; a.download = filename;
        a.click();
    }

    function showModal(id) { document.getElementById(id).style.display = 'flex'; }
    function hideModal(id) { document.getElementById(id).style.display = 'none'; }
    
    function clearAll() {
        if(confirm("Kya aap saara code delete karna chahte hain?")) {
            document.querySelectorAll('textarea').forEach(t => t.value = '');
            runPreview();
        }
    }

    function showShortcuts() {
        alert("Keyboard Shortcuts:\n\n‚Ä¢ Ctrl + Enter : Run Code\n‚Ä¢ Ctrl + S : Save HTML\n‚Ä¢ Ctrl + Q : Clear All");
    }

    window.addEventListener('keydown', (e) => {
        if (e.ctrlKey && e.key === 'Enter') { e.preventDefault(); runPreview(); }
        if (e.ctrlKey && e.key === 's') { e.preventDefault(); saveFile('html'); }
        if (e.ctrlKey && e.key === 'q') { e.preventDefault(); clearAll(); }
    });
</script>

</body>
</html>
